name: ğŸ‡°ğŸ‡· í•œêµ­ì–´ ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ìë™ ìƒì„±

on:
  push:
    tags:
      - 'v*'

permissions:
  contents: write
  pull-requests: read

jobs:
  korean-release:
    name: í•œêµ­ì–´ ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ìƒì„± ë° ë°°í¬
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ”§ Node.js 18 ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm ci

      - name: ğŸ·ï¸ íƒœê·¸ ì •ë³´ ì¶”ì¶œ
        id: tag
        run: |
          TAG=${GITHUB_REF#refs/tags/}
          echo "tag=$TAG" >> $GITHUB_OUTPUT
          echo "version=${TAG#v}" >> $GITHUB_OUTPUT

      - name: ğŸ“ í•œêµ­ì–´ ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ìƒì„±
        id: release_notes
        run: |
          node scripts/generate-korean-release.js ${{ steps.tag.outputs.tag }}

      - name: ğŸš€ GitHub ë¦´ë¦¬ì¦ˆ ìƒì„±
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          gh release create ${{ steps.tag.outputs.tag }} \
            --title "ğŸš€ Quad Chat ${{ steps.tag.outputs.tag }}" \
            --notes-file ./release-notes-ko.md \
            --repo bulhwi/quad-chat

      - name: ğŸ“¢ ìŠ¬ë™ ì•Œë¦¼ (ì„ íƒì‚¬í•­)
        if: success()
        run: |
          echo "âœ… ${{ steps.tag.outputs.tag }} ë²„ì „ì´ ì„±ê³µì ìœ¼ë¡œ ë¦´ë¦¬ì¦ˆë˜ì—ˆìŠµë‹ˆë‹¤!"
          echo "ğŸ”— ë¦´ë¦¬ì¦ˆ í˜ì´ì§€: https://github.com/bulhwi/quad-chat/releases/tag/${{ steps.tag.outputs.tag }}"